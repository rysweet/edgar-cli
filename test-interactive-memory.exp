#!/usr/bin/expect -f

set timeout 10
log_user 1

spawn node dist/index.js
expect "Edgar initialized successfully"

# First message - set context
expect "You:"
send "My name is Alice and I'm working on a TODO app in React\r"
expect "Edgar:"
expect "You:"

# Second message - should remember the context
send "What's my name?\r"
expect "Edgar:"
expect "You:"

# Third message - should remember the project
send "What kind of app am I building?\r"
expect "Edgar:"
expect "You:"

# Fourth message - test clearing
send "/clear\r"
expect "Conversation cleared"
expect "You:"

# Fifth message - after clear, should not remember
send "What's my name?\r"
expect "Edgar:"
expect "You:"

send "exit\r"
expect eof
